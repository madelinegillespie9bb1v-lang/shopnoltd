import { precompileTemplate } from "@ember/template-compilation";
export default precompileTemplate("{{#let this.model.postStream as |postStream|}}\n  {{#unless (and postStream.loaded postStream.loadedAllPosts)}}\n    {{hide-application-footer}}\n  {{/unless}}\n{{/let}}\n\n<DiscourseTopic\n  {{sticky-avatars}}\n  @multiSelect={{this.multiSelect}}\n  @enteredAt={{this.enteredAt}}\n  @topic={{this.model}}\n  @hasScrolled={{this.hasScrolled}}\n>\n  {{#if this.model}}\n    <AddCategoryTagClasses\n      @category={{this.model.category}}\n      @tags={{this.model.tags}}\n    />\n    <AddTopicStatusClasses @topic={{this.model}} />\n    {{body-class (concat \"archetype-\" this.model.archetype)}}\n    <div class=\"container\">\n      <DiscourseBanner\n        @overlay={{this.hasScrolled}}\n        @hide={{this.model.errorLoading}}\n      />\n    </div>\n  {{/if}}\n\n  {{#if this.showSharedDraftControls}}\n    <SharedDraftControls @topic={{this.model}} />\n  {{/if}}\n\n  <span>\n    <PluginOutlet\n      @name=\"topic-above-post-stream\"\n      @connectorTagName=\"div\"\n      @outletArgs={{hash\n        model=this.model\n        editFirstPost=(action \"editFirstPost\")\n      }}\n    />\n  </span>\n\n  {{#if this.model.postStream.loaded}}\n    {{#if this.model.postStream.firstPostPresent}}\n      <TopicTitle\n        @cancelled={{action \"cancelEditingTopic\"}}\n        @save={{action \"finishedEditingTopic\"}}\n        @model={{this.model}}\n      >\n        {{#if this.editingTopic}}\n          <div class=\"edit-topic-title\">\n            <PrivateMessageGlyph @shouldShow={{this.model.isPrivateMessage}} />\n\n            <TextField\n              @id=\"edit-title\"\n              @value={{this.buffered.title}}\n              @maxlength={{this.siteSettings.max_topic_title_length}}\n              @autofocus=\"true\"\n            />\n\n            {{#if this.showCategoryChooser}}\n              <CategoryChooser\n                @value={{this.buffered.category_id}}\n                @onChange={{action \"topicCategoryChanged\"}}\n                class=\"small\"\n              />\n            {{/if}}\n\n            {{#if this.canEditTags}}\n              <MiniTagChooser\n                @value={{this.buffered.tags}}\n                @onChange={{action \"topicTagsChanged\"}}\n                @options={{hash\n                  filterable=true\n                  categoryId=this.buffered.category_id\n                  minimum=this.minimumRequiredTags\n                  filterPlaceholder=\"tagging.choose_for_topic\"\n                  useHeaderFilter=true\n                }}\n              />\n            {{/if}}\n\n            <span>\n              <PluginOutlet\n                @name=\"edit-topic\"\n                @connectorTagName=\"div\"\n                @outletArgs={{hash model=this.model buffered=this.buffered}}\n              />\n            </span>\n\n            <div class=\"edit-controls\">\n              <DButton\n                @action={{action \"finishedEditingTopic\"}}\n                @icon=\"check\"\n                @ariaLabel=\"composer.save_edit\"\n                class=\"btn-primary submit-edit\"\n              />\n              <DButton\n                @action={{action \"cancelEditingTopic\"}}\n                @icon=\"xmark\"\n                @ariaLabel=\"composer.cancel\"\n                class=\"btn-default cancel-edit\"\n              />\n\n              {{#if this.canRemoveTopicFeaturedLink}}\n                <a\n                  href\n                  {{on \"click\" this.removeFeaturedLink}}\n                  class=\"remove-featured-link\"\n                  title={{i18n \"composer.remove_featured_link\"}}\n                >\n                  {{d-icon \"circle-xmark\"}}\n                  {{this.featuredLinkDomain}}\n                </a>\n              {{/if}}\n            </div>\n          </div>\n\n        {{else}}\n          <h1 data-topic-id={{this.model.id}}>\n            {{#unless this.model.is_warning}}\n              {{#if this.canSendPms}}\n                <PrivateMessageGlyph\n                  @shouldShow={{this.model.isPrivateMessage}}\n                  @href={{this.pmPath}}\n                  @title=\"topic_statuses.personal_message.title\"\n                  @ariaLabel=\"user.messages.inbox\"\n                />\n              {{else}}\n                <PrivateMessageGlyph\n                  @shouldShow={{this.model.isPrivateMessage}}\n                />\n              {{/if}}\n            {{/unless}}\n\n            {{#if this.model.details.loaded}}\n              <TopicStatus @topic={{this.model}} />\n              <a\n                href={{this.model.url}}\n                {{on \"click\" this.jumpTop}}\n                class=\"fancy-title\"\n              >\n                {{html-safe this.model.fancyTitle}}\n              </a>\n            {{/if}}\n\n            {{#if this.model.details.can_edit}}\n              <a\n                href\n                {{on \"click\" this.editTopic}}\n                class=\"edit-topic\"\n                title={{i18n \"edit_topic\"}}\n              >{{d-icon \"pencil\"}}</a>\n            {{/if}}\n\n            <PluginOutlet\n              @name=\"topic-title-suffix\"\n              @outletArgs={{hash model=this.model}}\n            />\n          </h1>\n\n          <PluginOutlet\n            @name=\"topic-category-wrapper\"\n            @outletArgs={{hash topic=this.model}}\n          >\n            <TopicCategory @topic={{this.model}} class=\"topic-category\" />\n          </PluginOutlet>\n\n        {{/if}}\n      </TopicTitle>\n\n      {{#if this.model.publishedPage}}\n        <div class=\"published-page-notice\">\n          <div class=\"details\">\n            {{#if this.model.publishedPage.public}}\n              <span class=\"is-public\">{{i18n\n                  \"topic.publish_page.public\"\n                }}</span>\n            {{/if}}\n            {{i18n \"topic.publish_page.topic_published\"}}\n            <div>\n              <a\n                href={{this.model.publishedPage.url}}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >{{this.model.publishedPage.url}}</a>\n            </div>\n          </div>\n          <div class=\"controls\">\n            <DButton\n              @icon=\"file\"\n              @label=\"topic.publish_page.publishing_settings\"\n              @action={{route-action \"showPagePublish\"}}\n            />\n          </div>\n        </div>\n      {{/if}}\n\n    {{/if}}\n\n    <div class=\"container posts\">\n      <div class=\"selected-posts {{unless this.multiSelect \'hidden\'}}\">\n        <SelectedPosts\n          @selectedPostsCount={{this.selectedPostsCount}}\n          @canSelectAll={{this.canSelectAll}}\n          @canDeselectAll={{this.canDeselectAll}}\n          @canDeleteSelected={{this.canDeleteSelected}}\n          @canMergeTopic={{this.canMergeTopic}}\n          @canChangeOwner={{this.canChangeOwner}}\n          @canMergePosts={{this.canMergePosts}}\n          @toggleMultiSelect={{action \"toggleMultiSelect\"}}\n          @mergePosts={{action \"mergePosts\"}}\n          @deleteSelected={{action \"deleteSelected\"}}\n          @deselectAll={{action \"deselectAll\"}}\n          @selectAll={{action \"selectAll\"}}\n        />\n      </div>\n\n      {{#if (and this.showBottomTopicMap this.loadedAllPosts)}}\n        <div class=\"topic-map --bottom\">\n          <TopicMap\n            @model={{this.model}}\n            @topicDetails={{this.model.details}}\n            @postStream={{this.model.postStream}}\n            @showPMMap={{eq this.model.archetype \"private_message\"}}\n            @showInvite={{route-action \"showInvite\"}}\n            @removeAllowedGroup={{action \"removeAllowedGroup\"}}\n            @removeAllowedUser={{action \"removeAllowedUser\"}}\n          />\n        </div>\n      {{/if}}\n\n      <PluginOutlet @name=\"above-timeline\" @connectorTagName=\"div\" />\n\n      <TopicNavigation\n        @topic={{this.model}}\n        @jumpToDate={{action \"jumpToDate\"}}\n        @jumpToIndex={{action \"jumpToIndex\"}}\n        class=\"topic-navigation\"\n        as |info|\n      >\n        <PluginOutlet\n          @name=\"topic-navigation\"\n          @connectorTagName=\"div\"\n          @outletArgs={{hash\n            topic=this.model\n            renderTimeline=info.renderTimeline\n            topicProgressExpanded=info.topicProgressExpanded\n          }}\n        />\n        {{#if info.renderTimeline}}\n          <TopicTimeline\n            @info={{info}}\n            @model={{this.model}}\n            @replyToPost={{action \"replyToPost\"}}\n            @showTopReplies={{action \"showTopReplies\"}}\n            @jumpToPostPrompt={{action \"jumpToPostPrompt\"}}\n            @enteredIndex={{this.enteredIndex}}\n            @prevEvent={{info.prevEvent}}\n            @jumpTop={{action \"jumpTop\"}}\n            @jumpBottom={{action \"jumpBottom\"}}\n            @jumpEnd={{action \"jumpEnd\"}}\n            @jumpToIndex={{action \"jumpToIndex\"}}\n            @toggleMultiSelect={{action \"toggleMultiSelect\"}}\n            @showTopicSlowModeUpdate={{route-action \"showTopicSlowModeUpdate\"}}\n            @deleteTopic={{action \"deleteTopic\"}}\n            @recoverTopic={{action \"recoverTopic\"}}\n            @toggleClosed={{action \"toggleClosed\"}}\n            @toggleArchived={{action \"toggleArchived\"}}\n            @toggleVisibility={{action \"toggleVisibility\"}}\n            @showTopicTimerModal={{route-action \"showTopicTimerModal\"}}\n            @showFeatureTopic={{route-action \"showFeatureTopic\"}}\n            @showChangeTimestamp={{route-action \"showChangeTimestamp\"}}\n            @resetBumpDate={{action \"resetBumpDate\"}}\n            @convertToPublicTopic={{action \"convertToPublicTopic\"}}\n            @convertToPrivateMessage={{action \"convertToPrivateMessage\"}}\n            @fullscreen={{info.topicProgressExpanded}}\n            @mobileView={{this.site.mobileView}}\n          />\n        {{else}}\n          <TopicProgress\n            @prevEvent={{info.prevEvent}}\n            @topic={{this.model}}\n            @expanded={{info.topicProgressExpanded}}\n            @jumpToPost={{action \"jumpToPost\"}}\n          >\n            <span>\n              <PluginOutlet\n                @name=\"before-topic-progress\"\n                @connectorTagName=\"div\"\n                @outletArgs={{hash\n                  model=this.model\n                  jumpToPost=(action \"jumpToPost\")\n                }}\n              />\n            </span>\n            <TopicAdminMenu\n              @topic={{this.model}}\n              @openUpwards=\"true\"\n              @rightSide=\"true\"\n              @toggleMultiSelect={{action \"toggleMultiSelect\"}}\n              @showTopicSlowModeUpdate={{route-action\n                \"showTopicSlowModeUpdate\"\n              }}\n              @deleteTopic={{action \"deleteTopic\"}}\n              @recoverTopic={{action \"recoverTopic\"}}\n              @toggleClosed={{action \"toggleClosed\"}}\n              @toggleArchived={{action \"toggleArchived\"}}\n              @toggleVisibility={{action \"toggleVisibility\"}}\n              @showTopicTimerModal={{route-action \"showTopicTimerModal\"}}\n              @showFeatureTopic={{route-action \"showFeatureTopic\"}}\n              @showChangeTimestamp={{route-action \"showChangeTimestamp\"}}\n              @resetBumpDate={{action \"resetBumpDate\"}}\n              @convertToPublicTopic={{action \"convertToPublicTopic\"}}\n              @convertToPrivateMessage={{action \"convertToPrivateMessage\"}}\n            />\n          </TopicProgress>\n        {{/if}}\n\n        <PluginOutlet\n          @name=\"topic-navigation-bottom\"\n          @connectorTagName=\"div\"\n          @outletArgs={{hash model=this.model}}\n        />\n      </TopicNavigation>\n\n      <div class=\"row\">\n        <section class=\"topic-area\" id=\"topic\" data-topic-id={{this.model.id}}>\n\n          <div class=\"posts-wrapper\">\n            <ConditionalLoadingSpinner\n              @condition={{this.model.postStream.loadingAbove}}\n            />\n\n            <span>\n              <PluginOutlet\n                @name=\"topic-above-posts\"\n                @connectorTagName=\"div\"\n                @outletArgs={{hash model=this.model}}\n              />\n            </span>\n\n            {{#unless this.model.postStream.loadingFilter}}\n              <ScrollingPostStream\n                @posts={{this.postsToRender}}\n                @canCreatePost={{this.model.details.can_create_post}}\n                @multiSelect={{this.multiSelect}}\n                @selectedPostsCount={{this.selectedPostsCount}}\n                @filteredPostsCount={{this.model.postStream.filteredPostsCount}}\n                @selectedQuery={{this.selectedQuery}}\n                @gaps={{this.model.postStream.gaps}}\n                @showReadIndicator={{this.model.show_read_indicator}}\n                @streamFilters={{this.model.postStream.streamFilters}}\n                @lastReadPostNumber={{this.userLastReadPostNumber}}\n                @highestPostNumber={{this.highestPostNumber}}\n                @showFlags={{action \"showPostFlags\"}}\n                @editPost={{action \"editPost\"}}\n                @showHistory={{route-action \"showHistory\"}}\n                @showLogin={{route-action \"showLogin\"}}\n                @showRawEmail={{route-action \"showRawEmail\"}}\n                @deletePost={{action \"deletePost\"}}\n                @permanentlyDeletePost={{action \"permanentlyDeletePost\"}}\n                @recoverPost={{action \"recoverPost\"}}\n                @expandHidden={{action \"expandHidden\"}}\n                @toggleBookmark={{action \"toggleBookmark\"}}\n                @togglePostType={{action \"togglePostType\"}}\n                @rebakePost={{action \"rebakePost\"}}\n                @changePostOwner={{action \"changePostOwner\"}}\n                @grantBadge={{action \"grantBadge\"}}\n                @changeNotice={{action \"changeNotice\"}}\n                @lockPost={{action \"lockPost\"}}\n                @unlockPost={{action \"unlockPost\"}}\n                @unhidePost={{action \"unhidePost\"}}\n                @replyToPost={{action \"replyToPost\"}}\n                @toggleWiki={{action \"toggleWiki\"}}\n                @showTopReplies={{action \"showTopReplies\"}}\n                @cancelFilter={{action \"cancelFilter\"}}\n                @removeAllowedUser={{action \"removeAllowedUser\"}}\n                @removeAllowedGroup={{action \"removeAllowedGroup\"}}\n                @topVisibleChanged={{action \"topVisibleChanged\"}}\n                @currentPostChanged={{action \"currentPostChanged\"}}\n                @currentPostScrolled={{action \"currentPostScrolled\"}}\n                @bottomVisibleChanged={{action \"bottomVisibleChanged\"}}\n                @togglePostSelection={{action \"togglePostSelection\"}}\n                @selectReplies={{action \"selectReplies\"}}\n                @selectBelow={{action \"selectBelow\"}}\n                @fillGapBefore={{action \"fillGapBefore\"}}\n                @fillGapAfter={{action \"fillGapAfter\"}}\n                @showInvite={{route-action \"showInvite\"}}\n                @showPagePublish={{route-action \"showPagePublish\"}}\n              />\n            {{/unless}}\n\n            <ConditionalLoadingSpinner\n              @condition={{this.model.postStream.loadingBelow}}\n            />\n          </div>\n          <div id=\"topic-bottom\"></div>\n\n          <ConditionalLoadingSpinner\n            @condition={{this.model.postStream.loadingFilter}}\n          >\n            {{#if this.loadedAllPosts}}\n\n              {{#if this.model.pending_posts}}\n                <div class=\"pending-posts\">\n                  {{#each this.model.pending_posts as |pending|}}\n                    <div\n                      class=\"reviewable-item\"\n                      data-reviewable-id={{pending.id}}\n                    >\n                      <div class=\"reviewable-meta-data\">\n                        <span class=\"reviewable-type\">\n                          {{i18n \"review.awaiting_approval\"}}\n                        </span>\n                        <span class=\"created-at\">\n                          {{age-with-tooltip pending.created_at}}\n                        </span>\n                      </div>\n                      <div class=\"post-contents-wrapper\">\n                        <ReviewableCreatedBy @user={{this.currentUser}} />\n                        <div class=\"post-contents\">\n                          <ReviewableCreatedByName @user={{this.currentUser}} />\n                          <div class=\"post-body\"><CookText\n                              @rawText={{pending.raw}}\n                            /></div>\n                        </div>\n                      </div>\n                      <div class=\"reviewable-actions\">\n                        <PluginOutlet\n                          @name=\"topic-additional-reviewable-actions\"\n                          @outletArgs={{hash pending=pending}}\n                        />\n                        <DButton\n                          @label=\"review.delete\"\n                          @icon=\"trash-can\"\n                          @action={{fn (action \"deletePending\") pending}}\n                          class=\"btn-danger\"\n                        />\n                      </div>\n                    </div>\n                  {{/each}}\n                </div>\n              {{/if}}\n\n              {{#if this.model.queued_posts_count}}\n                <div class=\"has-pending-posts\">\n                  <div>\n                    {{html-safe\n                      (i18n\n                        \"review.topic_has_pending\"\n                        count=this.model.queued_posts_count\n                      )\n                    }}\n                  </div>\n\n                  <LinkTo\n                    @route=\"review\"\n                    @query={{hash\n                      topic_id=this.model.id\n                      type=\"ReviewableQueuedPost\"\n                      status=\"pending\"\n                    }}\n                  >\n                    {{i18n \"review.view_pending\"}}\n                  </LinkTo>\n                </div>\n              {{/if}}\n\n              <SlowModeInfo\n                @topic={{this.model}}\n                @user={{this.currentUser}}\n                @tagName=\"\"\n              />\n\n              <TopicTimerInfo\n                @topicClosed={{this.model.closed}}\n                @statusType={{this.model.topic_timer.status_type}}\n                @statusUpdate={{this.model.topic_status_update}}\n                @executeAt={{this.model.topic_timer.execute_at}}\n                @basedOnLastPost={{this.model.topic_timer.based_on_last_post}}\n                @durationMinutes={{this.model.topic_timer.duration_minutes}}\n                @categoryId={{this.model.topic_timer.category_id}}\n                @showTopicTimerModal={{route-action \"showTopicTimerModal\"}}\n                @removeTopicTimer={{action\n                  \"removeTopicTimer\"\n                  this.model.topic_timer.status_type\n                  \"topic_timer\"\n                }}\n              />\n\n              {{#if this.showSelectedPostsAtBottom}}\n                <div\n                  class=\"selected-posts\n                    {{unless this.multiSelect \'hidden\'}}\n                    {{if this.showSelectedPostsAtBottom \'hidden\'}}\"\n                >\n                  <SelectedPosts\n                    @selectedPostsCount={{this.selectedPostsCount}}\n                    @canSelectAll={{this.canSelectAll}}\n                    @canDeselectAll={{this.canDeselectAll}}\n                    @canDeleteSelected={{this.canDeleteSelected}}\n                    @canMergeTopic={{this.canMergeTopic}}\n                    @canChangeOwner={{this.canChangeOwner}}\n                    @canMergePosts={{this.canMergePosts}}\n                    @toggleMultiSelect={{action \"toggleMultiSelect\"}}\n                    @mergePosts={{action \"mergePosts\"}}\n                    @deleteSelected={{action \"deleteSelected\"}}\n                    @deselectAll={{action \"deselectAll\"}}\n                    @selectAll={{action \"selectAll\"}}\n                  />\n                </div>\n              {{/if}}\n\n            {{/if}}\n          </ConditionalLoadingSpinner>\n\n          <PluginOutlet\n            @name=\"topic-area-bottom\"\n            @connectorTagName=\"div\"\n            @outletArgs={{hash model=this.model}}\n          />\n        </section>\n      </div>\n\n    </div>\n    {{#if this.loadedAllPosts}}\n      {{#if this.session.showSignupCta}}\n        {{! replace \"Log In to Reply\" with the infobox }}\n        <SignupCta />\n      {{else}}\n        {{#if this.currentUser}}\n          <span>\n            <PluginOutlet\n              @name=\"topic-above-footer-buttons\"\n              @connectorTagName=\"div\"\n              @outletArgs={{hash model=this.model}}\n            />\n          </span>\n\n          <TopicFooterButtons\n            @topic={{this.model}}\n            @toggleMultiSelect={{action \"toggleMultiSelect\"}}\n            @showTopicSlowModeUpdate={{route-action \"showTopicSlowModeUpdate\"}}\n            @deleteTopic={{action \"deleteTopic\"}}\n            @recoverTopic={{action \"recoverTopic\"}}\n            @toggleClosed={{action \"toggleClosed\"}}\n            @toggleArchived={{action \"toggleArchived\"}}\n            @toggleVisibility={{action \"toggleVisibility\"}}\n            @showTopicTimerModal={{route-action \"showTopicTimerModal\"}}\n            @showFeatureTopic={{route-action \"showFeatureTopic\"}}\n            @showChangeTimestamp={{route-action \"showChangeTimestamp\"}}\n            @resetBumpDate={{action \"resetBumpDate\"}}\n            @convertToPublicTopic={{action \"convertToPublicTopic\"}}\n            @convertToPrivateMessage={{action \"convertToPrivateMessage\"}}\n            @toggleBookmark={{action \"toggleBookmark\"}}\n            @showFlagTopic={{route-action \"showFlagTopic\"}}\n            @toggleArchiveMessage={{action \"toggleArchiveMessage\"}}\n            @editFirstPost={{action \"editFirstPost\"}}\n            @deferTopic={{action \"deferTopic\"}}\n            @replyToPost={{action \"replyToPost\"}}\n          />\n        {{else}}\n          <div id=\"topic-footer-buttons\">\n            <AnonymousTopicFooterButtons @topic={{this.model}} />\n          </div>\n        {{/if}}\n      {{/if}}\n\n      <br />\n\n      <span>\n        <PluginOutlet\n          @name=\"topic-above-suggested\"\n          @connectorTagName=\"div\"\n          @outletArgs={{hash model=this.model}}\n        />\n      </span>\n\n      <MoreTopics @topic={{this.model}} />\n      <PluginOutlet\n        @name=\"topic-below-suggested\"\n        @outletArgs={{hash model=this.model}}\n      />\n    {{/if}}\n  {{else}}\n    <div class=\"container\">\n      <ConditionalLoadingSpinner @condition={{this.noErrorYet}}>\n        {{#if this.model.errorHtml}}\n          <div class=\"not-found\">{{html-safe this.model.errorHtml}}</div>\n        {{else}}\n          <div class=\"topic-error\">\n            <div>{{this.model.errorMessage}}</div>\n            {{#if this.model.noRetry}}\n              {{#unless this.currentUser}}\n                <DButton\n                  @action={{route-action \"showLogin\"}}\n                  @icon=\"user\"\n                  @label=\"log_in\"\n                  class=\"btn-primary topic-retry\"\n                />\n              {{/unless}}\n            {{else}}\n              <DButton\n                @action={{action \"retryLoading\"}}\n                @icon=\"arrows-rotate\"\n                @label=\"errors.buttons.again\"\n                class=\"btn-primary topic-retry\"\n              />\n            {{/if}}\n          </div>\n          <ConditionalLoadingSpinner @condition={{this.retrying}} />\n        {{/if}}\n      </ConditionalLoadingSpinner>\n    </div>\n  {{/if}}\n\n  <PostTextSelection\n    @quoteState={{this.quoteState}}\n    @selectText={{action \"selectText\"}}\n    @buildQuoteMarkdown={{this.buildQuoteMarkdown}}\n    @editPost={{action \"editPost\"}}\n    @topic={{this.model}}\n  />\n</DiscourseTopic>",{ moduleName: "discourse/templates/topic.hbs" })